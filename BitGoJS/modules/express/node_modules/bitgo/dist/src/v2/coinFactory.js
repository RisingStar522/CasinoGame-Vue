"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * @prettier
 */
var statics_1 = require("@bitgo/statics");
var coins_1 = require("./coins");
var config_1 = require("../config");
var errors = require("../errors");
var CoinFactory = /** @class */ (function () {
    function CoinFactory() {
        this.coinConstructors = new Map();
    }
    /**
     *
     * @param bitgo
     * @param name
     * @throws CoinNotDefinedError
     * @throws UnsupportedCoinError
     */
    CoinFactory.prototype.getInstance = function (bitgo, name) {
        var staticsCoin;
        try {
            staticsCoin = statics_1.coins.get(name);
        }
        catch (e) {
            if (!(e instanceof statics_1.CoinNotDefinedError)) {
                throw e;
            }
        }
        var constructor = this.coinConstructors.get(name);
        if (constructor) {
            return constructor(bitgo, staticsCoin);
        }
        var ethConstructor = this.coinConstructors.get('eth');
        if (ethConstructor) {
            var ethCoin = ethConstructor(bitgo, staticsCoin);
            if (ethCoin.isValidAddress(name)) {
                var unknownTokenConstructor = coins_1.Erc20Token.createTokenConstructor({
                    type: 'unknown',
                    coin: 'eth',
                    network: 'Mainnet',
                    name: 'Unknown',
                    tokenContractAddress: name,
                    decimalPlaces: 0,
                });
                return unknownTokenConstructor(bitgo);
            }
        }
        throw new errors.UnsupportedCoinError(name);
    };
    CoinFactory.prototype.registerCoinConstructor = function (name, constructor) {
        if (this.coinConstructors.has(name)) {
            throw new Error("coin '" + name + "' is already defined");
        }
        this.coinConstructors.set(name, constructor);
    };
    return CoinFactory;
}());
exports.CoinFactory = CoinFactory;
exports.GlobalCoinFactory = new CoinFactory();
exports.GlobalCoinFactory.registerCoinConstructor('btc', coins_1.Btc.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('tbtc', coins_1.Tbtc.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('bch', coins_1.Bch.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('tbch', coins_1.Tbch.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('bsv', coins_1.Bsv.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('tbsv', coins_1.Tbsv.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('btg', coins_1.Btg.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('tbtg', coins_1.Tbtg.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('ltc', coins_1.Ltc.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('tltc', coins_1.Tltc.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('eos', coins_1.Eos.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('teos', coins_1.Teos.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('eth', coins_1.Eth.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('teth', coins_1.Teth.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('gteth', coins_1.Gteth.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('etc', coins_1.Etc.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('tetc', coins_1.Tetc.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('rbtc', coins_1.Rbtc.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('trbtc', coins_1.Trbtc.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('celo', coins_1.Celo.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('tcelo', coins_1.Tcelo.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('rmg', coins_1.Rmg.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('trmg', coins_1.Trmg.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('xrp', coins_1.Xrp.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('txrp', coins_1.Txrp.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('xlm', coins_1.Xlm.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('txlm', coins_1.Txlm.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('dash', coins_1.Dash.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('tdash', coins_1.Tdash.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('zec', coins_1.Zec.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('tzec', coins_1.Tzec.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('algo', coins_1.Algo.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('talgo', coins_1.Talgo.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('trx', coins_1.Trx.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('ttrx', coins_1.Ttrx.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('xtz', coins_1.Xtz.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('txtz', coins_1.Txtz.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('hbar', coins_1.Hbar.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('thbar', coins_1.Thbar.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('ofc', coins_1.Ofc.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('susd', coins_1.Susd.createInstance);
exports.GlobalCoinFactory.registerCoinConstructor('tsusd', coins_1.Tsusd.createInstance);
for (var _i = 0, _a = config_1.tokens.bitcoin.eth.tokens.concat(config_1.tokens.testnet.eth.tokens); _i < _a.length; _i++) {
    var token = _a[_i];
    var tokenConstructor = coins_1.Erc20Token.createTokenConstructor(token);
    exports.GlobalCoinFactory.registerCoinConstructor(token.type, tokenConstructor);
    exports.GlobalCoinFactory.registerCoinConstructor(token.tokenContractAddress, tokenConstructor);
}
for (var _b = 0, _c = config_1.tokens.bitcoin.xlm.tokens.concat(config_1.tokens.testnet.xlm.tokens); _b < _c.length; _b++) {
    var token = _c[_b];
    var tokenConstructor = coins_1.StellarToken.createTokenConstructor(token);
    exports.GlobalCoinFactory.registerCoinConstructor(token.type, tokenConstructor);
}
for (var _d = 0, _e = config_1.tokens.bitcoin.ofc.tokens.concat(config_1.tokens.testnet.ofc.tokens); _d < _e.length; _d++) {
    var ofcToken = _e[_d];
    var tokenConstructor = coins_1.OfcToken.createTokenConstructor(ofcToken);
    exports.GlobalCoinFactory.registerCoinConstructor(ofcToken.type, tokenConstructor);
}
for (var _f = 0, _g = config_1.tokens.bitcoin.celo.tokens.concat(config_1.tokens.testnet.celo.tokens); _f < _g.length; _f++) {
    var token = _g[_f];
    var tokenConstructor = coins_1.CeloToken.createTokenConstructor(token);
    exports.GlobalCoinFactory.registerCoinConstructor(token.type, tokenConstructor);
    exports.GlobalCoinFactory.registerCoinConstructor(token.tokenContractAddress, tokenConstructor);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29pbkZhY3RvcnkuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvdjIvY29pbkZhY3RvcnkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7R0FFRztBQUNILDBDQUF5RjtBQUd6RixpQ0ErQ2lCO0FBQ2pCLG9DQUFtQztBQUVuQyxrQ0FBb0M7QUFJcEM7SUFBQTtRQUNVLHFCQUFnQixHQUFHLElBQUksR0FBRyxFQUEyQixDQUFDO0lBaURoRSxDQUFDO0lBL0NDOzs7Ozs7T0FNRztJQUNJLGlDQUFXLEdBQWxCLFVBQW1CLEtBQVksRUFBRSxJQUFZO1FBQzNDLElBQUksV0FBVyxDQUFDO1FBQ2hCLElBQUk7WUFDRixXQUFXLEdBQUcsZUFBSyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQztTQUMvQjtRQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQ1YsSUFBSSxDQUFDLENBQUMsQ0FBQyxZQUFZLDZCQUFtQixDQUFDLEVBQUU7Z0JBQ3ZDLE1BQU0sQ0FBQyxDQUFDO2FBQ1Q7U0FDRjtRQUVELElBQU0sV0FBVyxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDcEQsSUFBSSxXQUFXLEVBQUU7WUFDZixPQUFPLFdBQVcsQ0FBQyxLQUFLLEVBQUUsV0FBVyxDQUFDLENBQUM7U0FDeEM7UUFFRCxJQUFNLGNBQWMsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3hELElBQUksY0FBYyxFQUFFO1lBQ2xCLElBQU0sT0FBTyxHQUFHLGNBQWMsQ0FBQyxLQUFLLEVBQUUsV0FBVyxDQUFDLENBQUM7WUFDbkQsSUFBSSxPQUFPLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxFQUFFO2dCQUNoQyxJQUFNLHVCQUF1QixHQUFHLGtCQUFVLENBQUMsc0JBQXNCLENBQUM7b0JBQ2hFLElBQUksRUFBRSxTQUFTO29CQUNmLElBQUksRUFB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QztJQUN4RSx5QkFBaUIsQ0FBQyx1QkFBdUIsQ0FBQyxLQUFLLENBQUMsb0JBQW9CLEVBQUUsZ0JBQWdCLENBQUMsQ0FBQztDQUN6RiIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQHByZXR0aWVyXG4gKi9cbmltcG9ydCB7IGNvaW5zLCBCYXNlQ29pbiBhcyBTdGF0aWNzQmFzZUNvaW4sIENvaW5Ob3REZWZpbmVkRXJyb3IgfSBmcm9tICdAYml0Z28vc3RhdGljcyc7XG5pbXBvcnQgeyBCaXRHbyB9IGZyb20gJy4uL2JpdGdvJztcbmltcG9ydCB7IEJhc2VDb2luIH0gZnJvbSAnLi9iYXNlQ29pbic7XG5pbXBvcnQge1xuICBBbGdvLFxuICBCY2gsXG4gIEJzdixcbiAgQnRjLFxuICBCdGcsXG4gIENlbG8sXG4gIERhc2gsXG4gIEVvcyxcbiAgRXRjLFxuICBFdGgsXG4gIEhiYXIsXG4gIEx0YyxcbiAgT2ZjLFxuICBSYnRjLFxuICBSbWcsXG4gIFN1c2QsXG4gIFRhbGdvLFxuICBUYmNoLFxuICBUYnN2LFxuICBUYnRjLFxuICBUYnRnLFxuICBUY2VsbyxcbiAgVGRhc2gsXG4gIFRlb3MsXG4gIFRldGMsXG4gIFRldGgsXG4gIEd0ZXRoLFxuICBUaGJhcixcbiAgVGx0YyxcbiAgVHJidGMsXG4gIFRybWcsXG4gIFRzdXNkLFxuICBUcngsXG4gIFR0cngsXG4gIFh0eixcbiAgVHh0eixcbiAgVHhsbSxcbiAgVHhycCxcbiAgVHplYyxcbiAgWGxtLFxuICBYcnAsXG4gIEVyYzIwVG9rZW4sXG4gIENlbG9Ub2tlbixcbiAgU3RlbGxhclRva2VuLFxuICBPZmNUb2tlbixcbiAgWmVjLFxufSBmcm9tICcuL2NvaW5zJztcbmltcG9ydCB7IHRva2VucyB9IGZyb20gJy4uL2NvbmZpZyc7XG5cbmltcG9ydCAqIGFzIGVycm9ycyBmcm9tICcuLi9lcnJvcnMnO1xuXG5leHBvcnQgdHlwZSBDb2luQ29uc3RydWN0b3IgPSAoYml0Z286IEJpdEdvLCBzdGF0aWNzQ29pbj86IFJlYWRvbmx5PFN0YXRpY3NCYXNlQ29pbj4pID0+IEJhc2VDb2luO1xuXG5leHBvcnQgY2xhc3MgQ29pbkZhY3Rvcnkge1xuICBwcml2YXRlIGNvaW5Db25zdHJ1Y3RvcnMgPSBuZXcgTWFwPHN0cmluZywgQ29pbkNvbnN0cnVjdG9yPigpO1xuXG4gIC8qKlxuICAgKlxuICAgKiBAcGFyYW0gYml0Z29cbiAgICogQHBhcmFtIG5hbWVcbiAgICogQHRocm93cyBDb2luTm90RGVmaW5lZEVycm9yXG4gICAqIEB0aHJvd3MgVW5zdXBwb3J0ZWRDb2luRXJyb3JcbiAgICovXG4gIHB1YmxpYyBnZXRJbnN0YW5jZShiaXRnbzogQml0R28sIG5hbWU6IHN0cmluZyk6IEJhc2VDb2luIHtcbiAgICBsZXQgc3RhdGljc0NvaW47XG4gICAgdHJ5IHtcbiAgICAgIHN0YXRpY3NDb2luID0gY29pbnMuZ2V0KG5hbWUpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGlmICghKGUgaW5zdGFuY2VvZiBDb2luTm90RGVmaW5lZEVycm9yKSkge1xuICAgICAgICB0aHJvdyBlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IGNvbnN0cnVjdG9yID0gdGhpcy5jb2luQ29uc3RydWN0b3JzLmdldChuYW1lKTtcbiAgICBpZiAoY29uc3RydWN0b3IpIHtcbiAgICAgIHJldHVybiBjb25zdHJ1Y3RvcihiaXRnbywgc3RhdGljc0NvaW4pO1xuICAgIH1cblxuICAgIGNvbnN0IGV0aENvbnN0cnVjdG9yID0gdGhpcy5jb2luQ29uc3RydWN0b3JzLmdldCgnZXRoJyk7XG4gICAgaWYgKGV0aENvbnN0cnVjdG9yKSB7XG4gICAgICBjb25zdCBldGhDb2luID0gZXRoQ29uc3RydWN0b3IoYml0Z28sIHN0YXRpY3NDb2luKTtcbiAgICAgIGlmIChldGhDb2luLmlzVmFsaWRBZGRyZXNzKG5hbWUpKSB7XG4gICAgICAgIGNvbnN0IHVua25vd25Ub2tlbkNvbnN0cnVjdG9yID0gRXJjMjBUb2tlbi5jcmVhdGVUb2tlbkNvbnN0cnVjdG9yKHtcbiAgICAgICAgICB0eXBlOiAndW5rbm93bicsXG4gICAgICAgICAgY29pbjogJ2V0aCcsXG4gICAgICAgICAgbmV0d29yazogJ01haW5uZXQnLFxuICAgICAgICAgIG5hbWU6ICdVbmtub3duJyxcbiAgICAgICAgICB0b2tlbkNvbnRyYWN0QWRkcmVzczogbmFtZSxcbiAgICAgICAgICBkZWNpbWFsUGxhY2VzOiAwLFxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHVua25vd25Ub2tlbkNvbnN0cnVjdG9yKGJpdGdvKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aHJvdyBuZXcgZXJyb3JzLlVuc3VwcG9ydGVkQ29pbkVycm9yKG5hbWUpO1xuICB9XG5cbiAgcHVibGljIHJlZ2lzdGVyQ29pbkNvbnN0cnVjdG9yKG5hbWU6IHN0cmluZywgY29uc3RydWN0b3I6IENvaW5Db25zdHJ1Y3Rvcikge1xuICAgIGlmICh0aGlzLmNvaW5Db25zdHJ1Y3RvcnMuaGFzKG5hbWUpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYGNvaW4gJyR7bmFtZX0nIGlzIGFscmVhZHkgZGVmaW5lZGApO1xuICAgIH1cbiAgICB0aGlzLmNvaW5Db25zdHJ1Y3RvcnMuc2V0KG5hbWUsIGNvbnN0cnVjdG9yKTtcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgR2xvYmFsQ29pbkZhY3Rvcnk6IENvaW5GYWN0b3J5ID0gbmV3IENvaW5GYWN0b3J5KCk7XG5cbkdsb2JhbENvaW5GYWN0b3J5LnJlZ2lzdGVyQ29pbkNvbnN0cnVjdG9yKCdidGMnLCBCdGMuY3JlYXRlSW5zdGFuY2UpO1xuR2xvYmFsQ29pbkZhY3RvcnkucmVnaXN0ZXJDb2luQ29uc3RydWN0b3IoJ3RidGMnLCBUYnRjLmNyZWF0ZUluc3RhbmNlKTtcbkdsb2JhbENvaW5GYWN0b3J5LnJlZ2lzdGVyQ29pbkNvbnN0cnVjdG9yKCdiY2gnLCBCY2guY3JlYXRlSW5zdGFuY2UpO1xuR2xvYmFsQ29pbkZhY3RvcnkucmVnaXN0ZXJDb2luQ29uc3RydWN0b3IoJ3RiY2gnLCBUYmNoLmNyZWF0ZUluc3RhbmNlKTtcbkdsb2JhbENvaW5GYWN0b3J5LnJlZ2lzdGVyQ29pbkNvbnN0cnVjdG9yKCdic3YnLCBCc3YuY3JlYXRlSW5zdGFuY2UpO1xuR2xvYmFsQ29pbkZhY3RvcnkucmVnaXN0ZXJDb2luQ29uc3RydWN0b3IoJ3Ric3YnLCBUYnN2LmNyZWF0ZUluc3RhbmNlKTtcbkdsb2JhbENvaW5GYWN0b3J5LnJlZ2lzdGVyQ29pbkNvbnN0cnVjdG9yKCdidGcnLCBCdGcuY3JlYXRlSW5zdGFuY2UpO1xuR2xvYmFsQ29pbkZhY3RvcnkucmVnaXN0ZXJDb2luQ29uc3RydWN0b3IoJ3RidGcnLCBUYnRnLmNyZWF0ZUluc3RhbmNlKTtcbkdsb2JhbENvaW5GYWN0b3J5LnJlZ2lzdGVyQ29pbkNvbnN0cnVjdG9yKCdsdGMnLCBMdGMuY3JlYXRlSW5zdGFuY2UpO1xuR2xvYmFsQ29pbkZhY3RvcnkucmVnaXN0ZXJDb2luQ29uc3RydWN0b3IoJ3RsdGMnLCBUbHRjLmNyZWF0ZUluc3RhbmNlKTtcbkdsb2JhbENvaW5GYWN0b3J5LnJlZ2lzdGVyQ29pbkNvbnN0cnVjdG9yKCdlb3MnLCBFb3MuY3JlYXRlSW5zdGFuY2UpO1xuR2xvYmFsQ29pbkZhY3RvcnkucmVnaXN0ZXJDb2luQ29uc3RydWN0b3IoJ3Rlb3MnLCBUZW9zLmNyZWF0ZUluc3RhbmNlKTtcbkdsb2JhbENvaW5GYWN0b3J5LnJlZ2lzdGVyQ29pbkNvbnN0cnVjdG9yKCdldGgnLCBFdGguY3JlYXRlSW5zdGFuY2UpO1xuR2xvYmFsQ29pbkZhY3RvcnkucmVnaXN0ZXJDb2luQ29uc3RydWN0b3IoJ3RldGgnLCBUZXRoLmNyZWF0ZUluc3RhbmNlKTtcbkdsb2JhbENvaW5GYWN0b3J5LnJlZ2lzdGVyQ29pbkNvbnN0cnVjdG9yKCdndGV0aCcsIEd0ZXRoLmNyZWF0ZUluc3RhbmNlKTtcbkdsb2JhbENvaW5GYWN0b3J5LnJlZ2lzdGVyQ29pbkNvbnN0cnVjdG9yKCdldGMnLCBFdGMuY3JlYXRlSW5zdGFuY2UpO1xuR2xvYmFsQ29pbkZhY3RvcnkucmVnaXN0ZXJDb2luQ29uc3RydWN0b3IoJ3RldGMnLCBUZXRjLmNyZWF0ZUluc3RhbmNlKTtcbkdsb2JhbENvaW5GYWN0b3J5LnJlZ2lzdGVyQ29pbkNvbnN0cnVjdG9yKCdyYnRjJywgUmJ0Yy5jcmVhdGVJbnN0YW5jZSk7XG5HbG9iYWxDb2luRmFjdG9yeS5yZWdpc3RlckNvaW5Db25zdHJ1Y3RvcigndHJidGMnLCBUcmJ0Yy5jcmVhdGVJbnN0YW5jZSk7XG5HbG9iYWxDb2luRmFjdG9yeS5yZWdpc3RlckNvaW5Db25zdHJ1Y3RvcignY2VsbycsIENlbG8uY3JlYXRlSW5zdGFuY2UpO1xuR2xvYmFsQ29pbkZhY3RvcnkucmVnaXN0ZXJDb2luQ29uc3RydWN0b3IoJ3RjZWxvJywgVGNlbG8uY3JlYXRlSW5zdGFuY2UpO1xuR2xvYmFsQ29pbkZhY3RvcnkucmVnaXN0ZXJDb2luQ29uc3RydWN0b3IoJ3JtZycsIFJtZy5jcmVhdGVJbnN0YW5jZSk7XG5HbG9iYWxDb2luRmFjdG9yeS5yZWdpc3RlckNvaW5Db25zdHJ1Y3RvcigndHJtZycsIFRybWcuY3JlYXRlSW5zdGFuY2UpO1xuR2xvYmFsQ29pbkZhY3RvcnkucmVnaXN0ZXJDb2luQ29uc3RydWN0b3IoJ3hycCcsIFhycC5jcmVhdGVJbnN0YW5jZSk7XG5HbG9iYWxDb2luRmFjdG9yeS5yZWdpc3RlckNvaW5Db25zdHJ1Y3RvcigndHhycCcsIFR4cnAuY3JlYXRlSW5zdGFuY2UpO1xuR2xvYmFsQ29pbkZhY3RvcnkucmVnaXN0ZXJDb2luQ29uc3RydWN0b3IoJ3hsbScsIFhsbS5jcmVhdGVJbnN0YW5jZSk7XG5HbG9iYWxDb2luRmFjdG9yeS5yZWdpc3RlckNvaW5Db25zdHJ1Y3RvcigndHhsbScsIFR4bG0uY3JlYXRlSW5zdGFuY2UpO1xuR2xvYmFsQ29pbkZhY3RvcnkucmVnaXN0ZXJDb2luQ29uc3RydWN0b3IoJ2Rhc2gnLCBEYXNoLmNyZWF0ZUluc3RhbmNlKTtcbkdsb2JhbENvaW5GYWN0b3J5LnJlZ2lzdGVyQ29pbkNvbnN0cnVjdG9yKCd0ZGFzaCcsIFRkYXNoLmNyZWF0ZUluc3RhbmNlKTtcbkdsb2JhbENvaW5GYWN0b3J5LnJlZ2lzdGVyQ29pbkNvbnN0cnVjdG9yKCd6ZWMnLCBaZWMuY3JlYXRlSW5zdGFuY2UpO1xuR2xvYmFsQ29pbkZhY3RvcnkucmVnaXN0ZXJDb2luQ29uc3RydWN0b3IoJ3R6ZWMnLCBUemVjLmNyZWF0ZUluc3RhbmNlKTtcbkdsb2JhbENvaW5GYWN0b3J5LnJlZ2lzdGVyQ29pbkNvbnN0cnVjdG9yKCdhbGdvJywgQWxnby5jcmVhdGVJbnN0YW5jZSk7XG5HbG9iYWxDb2luRmFjdG9yeS5yZWdpc3RlckNvaW5Db25zdHJ1Y3RvcigndGFsZ28nLCBUYWxnby5jcmVhdGVJbnN0YW5jZSk7XG5HbG9iYWxDb2luRmFjdG9yeS5yZWdpc3RlckNvaW5Db25zdHJ1Y3RvcigndHJ4JywgVHJ4LmNyZWF0ZUluc3RhbmNlKTtcbkdsb2JhbENvaW5GYWN0b3J5LnJlZ2lzdGVyQ29pbkNvbnN0cnVjdG9yKCd0dHJ4JywgVHRyeC5jcmVhdGVJbnN0YW5jZSk7XG5HbG9iYWxDb2luRmFjdG9yeS5yZWdpc3RlckNvaW5Db25zdHJ1Y3RvcigneHR6JywgWHR6LmNyZWF0ZUluc3RhbmNlKTtcbkdsb2JhbENvaW5GYWN0b3J5LnJlZ2lzdGVyQ29pbkNvbnN0cnVjdG9yKCd0eHR6JywgVHh0ei5jcmVhdGVJbnN0YW5jZSk7XG5HbG9iYWxDb2luRmFjdG9yeS5yZWdpc3RlckNvaW5Db25zdHJ1Y3RvcignaGJhcicsIEhiYXIuY3JlYXRlSW5zdGFuY2UpO1xuR2xvYmFsQ29pbkZhY3RvcnkucmVnaXN0ZXJDb2luQ29uc3RydWN0b3IoJ3RoYmFyJywgVGhiYXIuY3JlYXRlSW5zdGFuY2UpO1xuR2xvYmFsQ29pbkZhY3RvcnkucmVnaXN0ZXJDb2luQ29uc3RydWN0b3IoJ29mYycsIE9mYy5jcmVhdGVJbnN0YW5jZSk7XG5HbG9iYWxDb2luRmFjdG9yeS5yZWdpc3RlckNvaW5Db25zdHJ1Y3Rvcignc3VzZCcsIFN1c2QuY3JlYXRlSW5zdGFuY2UpO1xuR2xvYmFsQ29pbkZhY3RvcnkucmVnaXN0ZXJDb2luQ29uc3RydWN0b3IoJ3RzdXNkJywgVHN1c2QuY3JlYXRlSW5zdGFuY2UpO1xuXG5mb3IgKGNvbnN0IHRva2VuIG9mIFsuLi50b2tlbnMuYml0Y29pbi5ldGgudG9rZW5zLCAuLi50b2tlbnMudGVzdG5ldC5ldGgudG9rZW5zXSkge1xuICBjb25zdCB0b2tlbkNvbnN0cnVjdG9yID0gRXJjMjBUb2tlbi5jcmVhdGVUb2tlbkNvbnN0cnVjdG9yKHRva2VuKTtcbiAgR2xvYmFsQ29pbkZhY3RvcnkucmVnaXN0ZXJDb2luQ29uc3RydWN0b3IodG9rZW4udHlwZSwgdG9rZW5Db25zdHJ1Y3Rvcik7XG4gIEdsb2JhbENvaW5GYWN0b3J5LnJlZ2lzdGVyQ29pbkNvbnN0cnVjdG9yKHRva2VuLnRva2VuQ29udHJhY3RBZGRyZXNzLCB0b2tlbkNvbnN0cnVjdG9yKTtcbn1cblxuZm9yIChjb25zdCB0b2tlbiBvZiBbLi4udG9rZW5zLmJpdGNvaW4ueGxtLnRva2VucywgLi4udG9rZW5zLnRlc3RuZXQueGxtLnRva2Vuc10pIHtcbiAgY29uc3QgdG9rZW5Db25zdHJ1Y3RvciA9IFN0ZWxsYXJUb2tlbi5jcmVhdGVUb2tlbkNvbnN0cnVjdG9yKHRva2VuKTtcbiAgR2xvYmFsQ29pbkZhY3RvcnkucmVnaXN0ZXJDb2luQ29uc3RydWN0b3IodG9rZW4udHlwZSwgdG9rZW5Db25zdHJ1Y3Rvcik7XG59XG5cbmZvciAoY29uc3Qgb2ZjVG9rZW4gb2YgWy4uLnRva2Vucy5iaXRjb2luLm9mYy50b2tlbnMsIC4uLnRva2Vucy50ZXN0bmV0Lm9mYy50b2tlbnNdKSB7XG4gIGNvbnN0IHRva2VuQ29uc3RydWN0b3IgPSBPZmNUb2tlbi5jcmVhdGVUb2tlbkNvbnN0cnVjdG9yKG9mY1Rva2VuKTtcbiAgR2xvYmFsQ29pbkZhY3RvcnkucmVnaXN0ZXJDb2luQ29uc3RydWN0b3Iob2ZjVG9rZW4udHlwZSwgdG9rZW5Db25zdHJ1Y3Rvcik7XG59XG5cbmZvciAoY29uc3QgdG9rZW4gb2YgWy4uLnRva2Vucy5iaXRjb2luLmNlbG8udG9rZW5zLCAuLi50b2tlbnMudGVzdG5ldC5jZWxvLnRva2Vuc10pIHtcbiAgY29uc3QgdG9rZW5Db25zdHJ1Y3RvciA9IENlbG9Ub2tlbi5jcmVhdGVUb2tlbkNvbnN0cnVjdG9yKHRva2VuKTtcbiAgR2xvYmFsQ29pbkZhY3RvcnkucmVnaXN0ZXJDb2luQ29uc3RydWN0b3IodG9rZW4udHlwZSwgdG9rZW5Db25zdHJ1Y3Rvcik7XG4gIEdsb2JhbENvaW5GYWN0b3J5LnJlZ2lzdGVyQ29pbkNvbnN0cnVjdG9yKHRva2VuLnRva2VuQ29udHJhY3RBZGRyZXNzLCB0b2tlbkNvbnN0cnVjdG9yKTtcbn1cbiJdfQ==